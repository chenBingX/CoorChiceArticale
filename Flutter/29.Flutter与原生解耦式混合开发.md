[![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/Flutterå¿«é€Ÿä¸Šæ‰‹æŒ‡å—å°é¢2.JPG)](https://juejin.im/post/5c8f8e62e51d456a0f23d0fe)

[**ç›®å½•ä¼ é€é—¨ï¼š**ã€ŠFlutterå¿«é€Ÿä¸Šæ‰‹æŒ‡å—ã€‹å…ˆå¯¼ç¯‡](https://juejin.im/post/5c8f8e62e51d456a0f23d0fe)


è¿˜è®°å¾—åœ¨ [æ··åˆå¼€å‘(ä¸€)](https://juejin.im/post/5c90d2196fb9a070b96f03b3) ç« èŠ‚ä¸­ï¼Œè®²è§£äº†å¦‚ä½•å°†ä¸€ä¸ª Flutter å·¥ç¨‹å¼•å…¥ç°æœ‰åŸç”Ÿå·¥ç¨‹çš„å®˜æ–¹æ–¹æ¡ˆã€‚

ä½†è¿™ç§æ–¹æ¡ˆéœ€è¦ä¿®æ”¹åŸç”Ÿå·¥ç¨‹é…ç½®ï¼Œåœ¨å¤§å‹åˆä½œå¼€å‘çš„é¡¹ç›®ä¸­ä½¿ç”¨èµ·æ¥ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¤§å®¶éƒ½éœ€è¦ç¼–è¯‘è‡ªå·±çš„å·¥ç¨‹å’Œ Flutter å·¥ç¨‹ï¼Œè™½ç„¶ä½ å¯èƒ½å¹¶ä¸éœ€è¦è´Ÿè´£ Flutter çš„å¼€å‘ã€‚

é‚£èƒ½ä¸èƒ½ä»¥ä¾èµ–åº“çš„å½¢å¼å°† Flutter é¡¹ç›®ä¸åŸç”Ÿå·¥ç¨‹å®Œå…¨è§£è€¦å‘¢ï¼Ÿ

è¦ç”¨çš„æ—¶å€™ä¾èµ–ä¸Šï¼Œéœ€è¦ä¸‹çº¿çš„æ—¶å€™ç›´æ¥å»æ‰ä¾èµ–åº“å°±å¥½ã€‚

å½“ä½ çœ‹åˆ°è¿™ä¸ªç« èŠ‚çš„æ—¶å€™ï¼Œç­”æ¡ˆå¾ˆæ˜æ˜¾å•Šï¼Œå°±æ˜¯å¯ä»¥å•Š ğŸ˜‘ã€‚

ä½ å¯ä»¥æŠŠä½ çš„ Flutter å·¥ç¨‹æ‰“åŒ…æˆä¸€ä¸ª **aar** åŒ…ï¼Œç„¶åè®©åŸç”Ÿå·¥ç¨‹åœ¨éœ€è¦çš„æ—¶å€™ä¾èµ–è¿™ä¸ª **aar**ï¼Œä¸éœ€è¦çš„æ—¶å€™å»æ‰å°±å¥½ã€‚

æ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•å®ç°å§ã€‚

# 1. æ”¹é€ ä½ çš„ Flutter å·¥ç¨‹

> ğŸ’¡æç¤ºï¼šæŠŠ Flutter ç‰ˆæœ¬å‡çº§åˆ°æœ€æ–°ç‰ˆã€‚æœ¬æ–‡ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º 1.2.1 ç‰ˆæœ¬ã€‚

## 1.1 ä½ éœ€è¦ä¸€ä¸ª Flutter Application

å¦‚æœä½ æ˜¯ä» 0 å¼€å§‹ï¼Œé‚£ä¹ˆä½ è¦åšçš„ç¬¬ä¸€æ­¥å°±æ˜¯åˆ›å»ºä¸€ä¸ª **Flutter Application**ã€‚

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/åˆ›å»ºFlutterApp.png)

è¿™å¾ˆç®€å•ï¼Œè·Ÿç€æç¤ºä¸€æ­¥æ­¥æ¥ï¼Œä½ ä¹Ÿå¯ä»¥å‚è€ƒ [æ··åˆå¼€å‘(ä¸€)](https://juejin.im/post/5c90d2196fb9a070b96f03b3)ã€‚

å¦‚æœä½ æœ‰ä¸€ä¸ª **Flutter Module** å·¥ç¨‹ï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„ **Flutter Module** å·¥ç¨‹ç›®å½•ä¸‹çš„å‘½ä»¤è¡Œä¸­å…ˆè¾“å…¥ï¼š

```
flutter create temp
```

è¿™ä¼šåœ¨ä½ çš„ **Flutter Module** å·¥ç¨‹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º **temp** çš„ **Flutter Application** å·¥ç¨‹åŒ…ã€‚

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/Flutter-temp-android.png)

ä½ éœ€è¦åšçš„å°±æ˜¯æŠŠ **temp** ä¸­çš„ **android** åŒ…ç§»åŠ¨åˆ°ä½ çš„ **Flutter Module** å·¥ç¨‹æ ¹ç›®å½•ï¼Œæ¥ç€åˆ é™¤ **temp** å·¥ç¨‹åŒ…ã€‚

ç„¶åæŠŠå·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„ **pubspec.yaml** è¿›è¡Œå°ä¿®æ”¹ï¼š

```
flutter:
    ...
    module:
      androidPackage: com.coorchice.flutter_module
      iosBundleIdentifier: com.coorchice.flutterModule

*********ä¿®æ”¹å*************
flutter:
    ...
```

å°±æ˜¯æŠŠ `module:` éƒ¨åˆ†çš„é…ç½®åˆ é™¤ï¼Œç„¶åç‚¹å‡» `Packages get` åˆ·æ–°ä¸€ä¸‹å°±å¥½ã€‚

å½“å®Œæˆè¿™äº›æ“ä½œåªåï¼Œä½ åº”è¯¥ä¼šåœ¨ Flutter é¡¹ç›®ç›®å½•ä¸­çœ‹åˆ°æœ‰ä¸€ä¸ª **android** å·¥ç¨‹åŒ…ï¼š

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/ç›®å½•-android.png)

ä¹‹æ‰€ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸º Flutter è‡ªåŠ¨ç”Ÿæˆçš„ android å·¥ç¨‹ä¼šæœ‰ä¸€äº›ä¸“æœ‰çš„é…ç½®ï¼Œè‡ªå·±é‡æ–°åˆ›å»ºä¸€ä¸ªçš„è¯ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚


å¦‚æœä½ æœ¬èº«å°±æœ‰ä¸€ä¸ª Flutter Applicationï¼Œå°±å•¥éƒ½ä¸ç”¨å¹²äº†ã€‚

## 1.2 æ”¹é€  **android** å·¥ç¨‹åŒ…

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ª **android** å·¥ç¨‹åŒ…æ¥ç‚¹å„¿æ”¹é€  ğŸ› ã€‚

### 1.2.1 ä¿®æ”¹ android å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„ build.gradle

ä¿®æ”¹åˆšåˆšç”Ÿæˆçš„ android å·¥ç¨‹åŒ…çš„æ ¹ç›®å½•ä¸‹çš„ **build.gradle**ï¼š

```
subprojects {
    project.buildDir = "${rootProject.buildDir}/${project.name}"
}

*********ä¿®æ”¹å*************
subprojects {
    project.buildDir = "${rootProject.buildDir}/app"
}
```

ç›®çš„æ˜¯ä¸ºäº†è®©ä½ åœ¨ Flutter ä¸­å¼•å…¥çš„ç¬¬ä¸‰æ–¹æ’ä»¶èƒ½å¤Ÿè¢«æ‰“åŒ…åˆ°æœ€åç”Ÿæˆçš„ **aar** ä¸­ã€‚

å¦åˆ™åé¢è¿è¡Œçš„æ—¶å€™ä¼šå‡ºç°æ‰¾ä¸åˆ°ç¬¬ä¸‰æ–¹æ’ä»¶ç±»çš„ crashã€‚

### 1.2.2 ä¿®æ”¹ app ç›®å½•ä¸‹çš„ build.gradle

ä½ éœ€è¦åœ¨åˆšåˆšç”Ÿæˆçš„ android å·¥ç¨‹åŒ…ä¸­ï¼Œæ‰¾åˆ° **app** ç›®å½•ï¼Œç„¶åä¿®æ”¹è¯¥ç›®å½•ä¸‹çš„æ¨¡å— **build.gradle**ã€‚

1.ä¿®æ”¹ android å·¥ç¨‹ä¸º module å·¥ç¨‹ï¼š

```
apply plugin: 'com.android.application'

*********ä¿®æ”¹å*************

apply plugin: 'com.android.library'

```


2.åœ¨ `android{}` èŠ‚ç‚¹ä¸­å¢åŠ ï¼š

```
compileOptions {
   sourceCompatibility 1.8
   targetCompatibility 1.8
}
```

3.åˆ é™¤ `android{ defaultConfig {} }` ä¸­çš„ **applicationId** ã€‚

4.åœ¨ `dependencies{}` èŠ‚ç‚¹å¢åŠ ï¼š

```
implementation 'com.android.support:support-v13:27.1.1'
implementation 'com.android.support:support-annotations:27.1.1'
```

å› ä¸º Flutter çš„ sdk ä¸­ä¼šç”¨åˆ°è¿™äº›åº“ã€‚

### 1.2.3 å¢åŠ  facade åŒ…

**facade** åŒ…å®é™…ä¸Šåœ¨ **Flutter Module** å·¥ç¨‹ä¸­çš„ `.android` ä¸­ä¼šè¢«ç”Ÿæˆã€‚

å®ƒåŒ…å«äº†ä¸¤ä¸ªå°è£…å¥½çš„ **Java** ä»£ç æ–‡ä»¶ï¼Œæ¯”å¦‚å¸¸ç”¨çš„ï¼š

```
FlutterView flutterView = Flutter.createView(
   activity,
   getLifecycle(),
   "route0"
);
```

å°±æ˜¯åœ¨è¿™ä¸ªåŒ…ä¸­ã€‚

ä½ å¯ä¸‹è½½ [**facadeæ–‡ä»¶.zip**](https://raw.githubusercontent.com/chenBingX/img/master/å…¶å®ƒæ–‡ä»¶/facade.zip) è§£å‹æ”¾åˆ° android å·¥ç¨‹åŒ…çš„ `app/src/main/java/io/flutter/` ä¸‹ï¼š

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/facdeä½ç½®.png)


### 1.2.4 ä¿®æ”¹ AndroidManifest.xml

ä¸ºäº†é¿å…åç»­ **aar** åŒ…å¼•å…¥åŸç”Ÿå·¥ç¨‹ï¼Œå¯¼è‡´æ‰“åŒ…æ—¶çš„å†²çªï¼Œéœ€è¦æŠŠ android å·¥ç¨‹åŒ…çš„ **AndroidManifest.xml** è¿›è¡Œä¿®æ”¹ã€‚

æŠŠæ•´ä¸ª `<application>` èŠ‚ç‚¹åˆ é™¤å°±å¯ä»¥äº† ğŸ˜ã€‚

# 2.æŠŠ aar å¼•å…¥åŸç”Ÿå·¥ç¨‹

## 2.1 æ‰“åŒ… aar

å®Œæˆä¸Šé¢çš„æ­¥éª¤åï¼Œå°±å¯ä»¥å¼€å§‹æ‰“åŒ… **aar** äº†ã€‚

åœ¨ä½ çš„ Flutter é¡¹ç›®æ ¹ç›®å½•çš„å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š

```
flutter build apk
```
ç­‰å¾…ç¼–è¯‘å®Œæˆ..

ç”Ÿæˆçš„ **aar** åŒ…åœ¨ `<ä½ çš„Flutteré¡¹ç›®ç›®å½•>/build/app/outputs/aar/app-release.aar`ã€‚

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/Flutteraar.png)

## 2.2 åœ¨åŸç”Ÿé¡¹ç›®ä¸­æ·»åŠ  aar

ä½ å¯ä»¥æŠŠç”Ÿæˆçš„ aar åŒ…æ”¾åˆ°è¿œç¨‹ä»“åº“ï¼Œé€šè¿‡ `implementation` æ¥ä¾èµ–ã€‚

ä¹Ÿå¯ä»¥æŠŠ aar åŒ…å¤åˆ¶åˆ° `app/libs` ä¸‹ï¼Œç„¶ååœ¨ app çš„ build.gradle ä¸­åŠ å…¥ï¼š

```
implementation fileTree(include: ['*.aar'], dir: 'libs')
```

æ¥ç€åˆ·æ–°ä¸€ä¸‹å·¥ç¨‹å°±å¯ä»¥äº†ã€‚

ğŸ–¼ çœ‹ä¸ªè¿è¡Œèµ·æ¥çš„æ•ˆæœï¼š

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/flutter_android.png)

æ­å–œä½ ï¼ä½ ç°åœ¨å·²ç»æŠŠ Flutter å·¥ç¨‹è§£è€¦æˆä¸€ä¸ª **aar** åŒ…äº†ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åŸç”Ÿé¡¹ç›®ä¸­éšæ—¶æ·»åŠ å’Œç§»é™¤äº† ğŸ‰ã€‚









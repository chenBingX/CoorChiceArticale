[![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/Flutterå¿«é€Ÿä¸Šæ‰‹æŒ‡å—å°é¢2.JPG)](https://juejin.im/post/5c8f8e62e51d456a0f23d0fe)

[**ç›®å½•ä¼ é€é—¨ï¼š**ã€ŠFlutterå¿«é€Ÿä¸Šæ‰‹æŒ‡å—ã€‹å…ˆå¯¼ç¯‡](https://juejin.im/post/5c8f8e62e51d456a0f23d0fe)


åœ¨ Flutter ä¸­ï¼ŒåŠ¨ç”»è¢«åˆ†ä¸ºä¸¤å¤§ç±»ï¼š**Tween animation(è¡¥é—´åŠ¨ç”»)** å’Œ **Physics-based animation(ç‰©ç†åŠ¨ç”»)**ã€‚


1. Tween animation(è¡¥é—´åŠ¨ç”»)  

    å®šä¹‰äº†åŠ¨ç”»çš„ **åˆå§‹çŠ¶æ€** å’Œ **ç»ˆæ­¢çŠ¶æ€**ï¼Œåœ¨æŒ‡å®šçš„ä¸€æ®µæ—¶é—´å†…å®ŒæˆçŠ¶æ€çš„è¿‡åº¦ã€‚  

    æœŸé—´å¯ä»¥ä»¥çº¿æ€§å’Œéçº¿æ€§çš„æ–¹å¼æ§åˆ¶è¿‡åº¦çš„é€Ÿåº¦ã€‚  
    
    
2. Physics-based animation(ç‰©ç†åŠ¨ç”»)
    
    æ¨¡æ‹Ÿç°å®ä¸–ç•Œç‰©ä½“è¿åŠ¨çš„åŠ¨ç”»ã€‚æ¯”å¦‚ï¼šè‡ªç”±è½ä½“è¿åŠ¨ã€åŠ é€Ÿåº¦ç­‰ã€‚
    
    

ä¸ç®¡æ˜¯ **TweenAnimation** è¿˜æ˜¯ **Physics-baseAnimation** 
æœ€ç»ˆéƒ½æ˜¯é€šè¿‡è®¡ç®—å‡ºä¸€ç³»åˆ—çš„å€¼æ¥ä¿®æ”¹è§†å›¾çš„å±æ€§ï¼Œä»è€Œè®©è§†å›¾ "åŠ¨èµ·æ¥"ã€‚  


# 1.ä¸€ä¸ªåŠ¨ç”»çš„ä¾‹å­  

```
class AnimPage2 extends StatefulWidget {
  @override
  State<StatefulWidget> createState() {
    // TODO: implement createState
    return _AnimPage2();
  }
}

class _AnimPage2 extends State<AnimPage2> with TickerProviderStateMixin{

  var w = 100.0;
  var h = 100.0;

  Animation<double> animation;
  AnimationController animationController;


  @override
  void initState() {
      super.initState();
      // åˆ›å»º AnimationControllerï¼Œç”¨äºæ§åˆ¶åŠ¨ç”»
      // å¿…é¡»æä¾›åŠ¨ç”»æ—¶é—´
      animationController = new AnimationController(vsync: this,duration: Duration(milliseconds: 1500));
      // åˆ›å»ºä¸€ä¸ªæ’å€¼å™¨ï¼Œå…³è” AnimationControllerï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ Animation å¯¹è±¡
      animation = Tween<double>(begin: 100.0, end: 100.0*2.0).animate(animationController);

      animationController.addListener((){
        // å½“åŠ¨ç”»æ›´æ–°æ—¶ä¼šè°ƒç”¨
        // éœ€è¦åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œè°ƒç”¨ setState() æ¥è§¦å‘è§†å›¾åˆ·æ–°
        setState(() {
        });
      });
      // å¼€å§‹æ’­æ”¾åŠ¨ç”»
      animationController.forward();
  }

  @override
  Widget build(BuildContext context) {
    // TODO: implement build
    return Scaffold(
      appBar: AppBar(
        title: Text('Anim Demo 2'),
      ),
      body: Container(
        alignment: Alignment.center,
        child: SizedBox(
          // è·å–æ’å€¼å™¨è®¡ç®—å‡ºçš„ value
          // ä½œä¸ºå±æ€§å€¼
          width: animation.value,
          height: animation.value,
          child: Container(
            color: Colors.lightBlue,
          ),
        ),
      ),
    );
  }

  @override
  void dispose() {
    super.dispose();
    // åŠ¨ç”»ä½¿ç”¨å®Œæˆåå¿…éœ€è¦é”€æ¯
    animationController.dispose();
  }
}
```  

çœ‹çœ‹æ•ˆæœï¼š  

![](https://raw.githubusercontent.com/chenBingX/img/master/Flutter/AnimDemo1.gif)  

# 2.åŠ¨ç”»ä¸­çš„æ ¸å¿ƒè§’è‰²

é€šè¿‡è§‚å¯Ÿä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥çœ‹å‡ºï¼Œåœ¨ Flutter ä¸­å®ç°åŠ¨ç”»æ•ˆæœéœ€è¦æ¶‰åŠåˆ°çš„å‡ ä¸ªæ ¸å¿ƒè§’è‰² ğŸ­

- Animationï¼šåŠ¨ç”»å¯¹è±¡ã€‚  

- AnimationControllerï¼šç»§æ‰¿è‡ª
  Animationï¼Œä½†å®ƒèƒ½æ§åˆ¶åŠ¨ç”»çš„æ’­æ”¾ã€åœæ­¢ç­‰ã€‚ä¸éœ€è¦æ—¶å¿…é¡»è°ƒç”¨ `dispose()` é‡Šæ”¾æ‰ã€‚

- Animatableï¼šæ’å€¼å™¨ï¼Œç”¨äºäº§ç”ŸåŠ¨ç”»è¿‡ç¨‹ä¸­ä¸€ç³»åˆ—çš„å€¼ã€‚


åœ¨ Flutter ä¸­ï¼Œå®ç°åŠ¨ç”»çš„æ ¸å¿ƒæ˜¯ï¼š 

1. é€šè¿‡ **æ’å€¼å™¨** äº§ç”Ÿä¸€ç³»åˆ—çš„å€¼; 

2. åœ¨å€¼æ›´æ–°çš„å›è°ƒç›‘å¬ `addListener()` ä¸­ï¼Œé€šè¿‡ `setState()` åˆ·æ–°è§†å›¾ï¼› 

3. å°† **æ’å€¼å™¨** äº§ç”Ÿçš„å€¼è®¾ç½®åˆ°ç›¸åº”çš„è§†å›¾å±æ€§ä¸Šã€‚  

# 3.AnimationController

AnimationController ç»§æ‰¿è‡ª **Animation**ã€‚  

å°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œå®ƒæ˜¯åŠ¨ç”»çš„æ§åˆ¶å™¨ï¼Œèƒ½å¤Ÿæ§åˆ¶åŠ¨ç”»çš„æ’­æ”¾ã€åœæ­¢ã€é‡Šæ”¾ç­‰ã€‚  

## 3.1 AnimationController å¸¸ç”¨å±æ€§

|å±æ€§|ç±»å‹|è¯´æ˜|
|---|---|---|
|duration|Duration|åŠ¨ç”»æ—¶é•¿|
|lowerBound|double|è®¾ç½®åŠ¨ç”»å¼€å§‹çš„æœ€å°å€¼|
|upperBound|double|è®¾ç½®åŠ¨ç”»ç»“æŸçš„æœ€å¤§å€¼|
|vsync|TickerProvider|ç”¨äºç›‘å¬ç³»ç»Ÿçš„ Vsync ä¿¡å·ã€‚å½“ä¸€ä¸ª Vsync ä¿¡æ¯å‘å‡ºæ—¶ï¼Œèƒ½å¤Ÿè§¦å‘åˆ·æ–°æ•°å€¼ï¼Œé©±åŠ¨åŠ¨ç”»|

## 3.2 AnimationController å¸¸ç”¨å‡½æ•°

- `forward()`  
    
    å¼€å§‹æ’­æ”¾åŠ¨ç”»ï¼Œè°ƒç”¨å®ƒå°±æ²¡é”™äº†ã€‚  
    
- `stop()`  
    
    åœæ­¢åŠ¨ç”»ã€‚  
    
- `reset()`  
    
    é‡ç½®åŠ¨ç”»ã€‚  
    
- `reverse()`  
    
    åå‘æ’­æ”¾åŠ¨ç”»ã€‚å¿…é¡»å¤„äºæ­£å‘åŠ¨ç”»æ’­æ”¾å®Œæˆçš„çŠ¶æ€æ‰æœ‰ç”¨ã€‚  
    
- `dispose()`  
    
    é‡Šæ”¾åŠ¨ç”»å ç”¨èµ„æºã€‚
    
- `fling()`  
    
    é€šè¿‡å†…éƒ¨çš„ **SpringSimulation** äº§ç”Ÿä¸€ç³»åˆ—å€¼æ¥é©±åŠ¨åŠ¨ç”»ï¼Œå…¶å€¼çš„äº§ç”Ÿç¬¦åˆ **èƒ¡å…‹å®šå¾‹**ã€‚
    
    æ­¤æ—¶ä¸éœ€è¦å†è®¾ç½® `duration`ï¼Œè®¾ç½®äº†ä¹Ÿæ²¡ç”¨ã€‚  
    
    åœ¨åˆ›å»ºåˆ—è¡¨æ»‘åŠ¨åŠ¨ç”»æ—¶ï¼Œä½ å¯èƒ½ä¼šç”¨åˆ°å®ƒã€‚

    è¿™å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª **Physics-based animation**ã€‚
    
    
- `repeat()`  
    
    å¾ªç¯æ’­æ”¾åŠ¨ç”»ã€‚
    
- `animateWith()`
    
    é€šè¿‡ **Simulation** æ¥äº§ç”Ÿå€¼é©±åŠ¨åŠ¨ç”»ã€‚  
   
   
## 3.3 äº¤é”™åŠ¨ç”»-åŒæ—¶æ’­æ”¾å¤šä¸ªåŠ¨ç”»

åœ¨ Flutter ä¸­åŒæ—¶æ’­æ”¾å¤šä¸ªåŠ¨ç”»ï¼Œåªéœ€è¦ä½¿ç”¨åŒä¸€ä¸ª  **AnimationController** å°±è¡Œã€‚  

```
var animationController = new AnimationController(vsync: this,duration: Duration(milliseconds: 1500));
var animation1 = Tween<double>(begin: 100.0, end: 100.0*2.0).animate(animationController);
var animation2 = Tween<double>(begin: 0.0, end: 1.0).animate(animationController);

animationController.forward();
```

é€šè¿‡åŒä¸€ä¸ª `animationController` å¯¹è±¡å°±å¯ä»¥åŒæ—¶æ§åˆ¶ `animation1` å’Œ `animation2` ä¸¤ä¸ªåŠ¨ç”»äº†ã€‚
    
---

åˆ°æ­¤ï¼Œè¯»è€…åº”è¯¥å·²ç»èƒ½åˆ›å»ºè‡ªå·±çš„åŠ¨ç”» Demo äº†ã€‚  
 